@inherits DotNetNuke.Web.Mvc.Framework.DnnWebViewPage<ContingentDirectoryViewModel>
@using System.Collections.Generic
@using DotNetNuke.Collections
@using DotNetNuke.Web.Mvc.Helpers
@using DotNetNuke.Web.Client.ClientResourceManagement
@using DotNetNuke.Framework
@using DotNetNuke.Common
@using DotNetNuke.Common.Utilities
@using R7.University.Components
@using R7.University.ModelExtensions
@using R7.University.ViewModels
@using R7.University.Controls.ViewModels
@using R7.University.EduProgramProfiles.Models
@using R7.University.EduProgramProfiles.ViewModels
@{
    ClientResourceManager.RegisterStyleSheet (Dnn.DnnPage, "~/DesktopModules/MVC/R7.University/R7.University/css/module.css");
}
@if (Model.IsEmpty) {
    if (Dnn.ModuleContext.IsEditable) {
        <p class="dnnFormMessage dnnFormInfo">@Dnn.LocalizeString("NothingToDisplay.Text")</p>
    }
    else {
        var containerControl = Globals.FindControlRecursiveDown (Dnn.DnnPage, "ctr" + Dnn.ModuleContext.ModuleId);
        containerControl.Visible = false;
    }
}
else {
    <div class="u8y-contingent-directory">
        <div class="table-responsive">
            <table class="table table-striped table-bordered table-hover u8y-contingent-directory-table">
                <thead>
    			    <tr>
        			    @if (Dnn.ModuleContext.IsEditable) {
                            <th scope="col" rowspan="2"></th>
                        }
    				    <th scope="col" rowspan="2">@Dnn.LocalizeString("EduCode.Column")</th>
        			    <th scope="col" rowspan="2">@Dnn.LocalizeString("EduProgram.Column")</th>
    				    <th scope="col" rowspan="2">@Dnn.LocalizeString("EduLevel.Column")</th>
					    @if (Model.Settings.Mode == ContingentDirectoryMode.Vacant) {
    				        <th scope="col" rowspan="2">@Dnn.LocalizeString("Course.Column")</th>
                        }
    				    <th scope="col" rowspan="2">@Dnn.LocalizeString("EduForm.Column")</th>
					    @if (Model.Settings.Mode == ContingentDirectoryMode.Vacant) {
                            <th scope="col" colspan="4">@Dnn.LocalizeString("VacantPlaces.Column")</th>
                        }
    				</tr>
                    <tr>
					    @if (Model.Settings.Mode == ContingentDirectoryMode.Vacant) {
                            <th scope="col">@Dnn.LocalizeString("VacantFB.Column")</th>
                            <th scope="col">@Dnn.LocalizeString("VacantRB.Column")</th>
                            <th scope="col">@Dnn.LocalizeString("VacantMB.Column")</th>
                            <th scope="col">@Dnn.LocalizeString("VacantBC.Column")</th>
                        }
					</tr>
				</thead>
        	    <tbody>
            	    @foreach (var cv in Model.ContingentViewModels) {
                        <tr class="@cv.CssClass">
    				        @if (Dnn.ModuleContext.IsEditable) {
                                <td><a href="@cv.EditUrl"><img src="@UniversityIcons.Edit" /></a></td>
                            }
            			    <td itemprop="eduCode">@cv.EduProgramProfile.EduProgram.Code</td>
    				        <td itemprop="eduName">@cv.EduProgramProfileTitle</td>
                            <td itemprop="eduLevel">@cv.EduProgramProfile.EduLevel.Title</td>
					        @if (Model.Settings.Mode == ContingentDirectoryMode.Vacant) {
    				            <td>@(Model.LastYear.Year - @cv.Year.Year + 1)</td>
                            }
    				        <td itemprop="eduForm">@cv.EduFormTitle</td>
					        @if (Model.Settings.Mode == ContingentDirectoryMode.Vacant) {
                                <td>@cv.VacantFB</td>
                                <td>@cv.VacantRB</td>
                                <td>@cv.VacantMB</td>
                                <td>@cv.VacantBC</td>
                            }
    					</tr>
                    }
        		</tbody>
            </table>
    	</div>
        @Html.Partial("~/DesktopModules/MVC/R7.University/R7.University.Controls/Views/_AgplSignature.cshtml", new AgplSignatureViewModel ())
    </div>
}